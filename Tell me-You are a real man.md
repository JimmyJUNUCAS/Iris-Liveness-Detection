# Iris-Liveness-Detection

Iris Liveness Detection &amp; Iris anti-spoofing &amp; Fake Iris Detection

啊哈，年后工作第二个周末了，公众号如约又跟大家见面啦。先update状态，由于转到硕士，从17年元旦就开始做项目。又由于摊上了一个“非常nice”的老板，项目进度制定，迷之感人。所以从回所一直处于非常奔忙的状态。代码也还在完善中。这样就导致我很难有时间去看自己真正感兴趣的内容。只能将项目的工作进行简单总结。今天就为大家带来最近一直在做的一个东西，虹膜识别。

大家对于虹膜识别应该不会陌生。之前多出现于科幻电影等影视作品之中。现在有很多具体的应用。无论人脸识别亦或虹膜识别都开始在我们的生活中扮演一些角色。春节回家北京站的检票环节，就由原来的人工检票变成了识别系统的智能检票。这个识别系统是由人脸识别以及卡片识别共同组成。在对于安全性要求很高的场景，虹膜识别的使用率就更高。

虹膜识别的流程是：1 获取虹膜图像；2 虹膜检测；3 活体检测；4 虹膜分割；5 虹膜识别；
先得到一张虹膜的图像，要判断里面有没有虹膜，有的话就进行加一步不然就停止。有虹膜之后就要判断这个虹膜是否是真人的，有可能是一张虹膜的图片来冒充一个真人。也有可能是一段视频来冒充真人。这部分就是我在这个项目中主要负责的工作。判定是真人的情况下，我们要把虹膜分割出来，就是把一圈圆环跟瞳仁跟眼白分割出来。分割之后就可以进行识别。判定此虹膜是否在数据库中，也可以理解为一种虹膜的检索任务。以上即为虹膜检索任务的主体流程。接下来主要介绍我负责的活体检测部分的具体操作。

我做活体检测任务时，先进行了部分的调研工作。分别调研了现有的针对人脸检测算法，虹膜检测算法。
针对活体检测，我们可以大体将方法分为两种，交互式方法与非交互式方法。

交互式方法较为简单，需要人的配合完成检测的任务。比如人脸检测任务中，通过指令下达点头，摇头，左转，右转等。之后验证指令后反应判断是否为活体。微众银行活体检测的方法是用户需要对着摄像机镜头读出一串随机出现的数字，平安普惠APP活体检测方法是要求用户按照指令做出诸如摇头、张口、点头等动作。

非交互方法是集中精力研究的方式。因为交互方法的验证时间较长，用户体验不好，非交互方法是较为理想的。也是研究的重点。
1 热红外 通过热红外探测器直接探测温度，直接验证是否是人体
2 3D建模 通过双摄像头，构建人脸的3维立体模型
3 光流法 利用图像序列中的像素强度数据的时域变化和相关性来确定各自像素位置的“运动”，从图像序列中得到各个像素点的运行信息，可以检测眼球移动和眨眼。
4 利用细小纹理作为区分。真虹膜与假虹膜图像反光率不同，反应在最终图像上即为图像的纹理不同。通过区分纹理来区分真假虹膜。除了利用纹理之外也有利用角点信息（SIFT特征）来作为真假虹膜区分的方法。

接下来主要介绍第四种方法的一些研究方法，在一些虹膜识别活体检测比赛中一般都采用这样的一种方法。将活体检测问题转化为分类问题。通过提取真假虹膜的一些特征（纹理特征，角点特征，结构特征等），然后进行特征融合或者特征编码，之后训练一个分类器来完成分类任务。对应着之前介绍的分类任务中的底层方法以及中层方法。

1 底层方法：提取底层特征（SIFT，HOG，LBP）等特征 + 分类器（SVM）
2 中层方法：对提取的底层特征进行编码，利用编码后的特征 + 分类器（SVM）
3 高层方法：端到端的深度学习方法

[1]论文介绍了一种中层方法，文章是谭铁牛院士组发表在TPAMI上的文章，超级棒。顺便提一句，谭院士创办的依托自动化所的中科虹霸公司是我们的竞对之一呦，手动再见呢。文章的主要贡献是提取底层特征选择了SIFT，在创建字典是在聚类阶段替换了传统的kmeans方法，而采用层次聚类的方法，借鉴字典树Vocabulary tree （VT），通过循环调用kmeans算法。因此更大的词典能够被用来建模图像的视觉内容。在编码阶段借鉴llc思路。
总结为此方法编解码阶段，在创建字典时用分层聚类取代kmeans，在编码时用LLC取代VQ，利用二者组合创新新的编码方式，最后接一个SVM进行分类。分类效果很不错。

[2]论文主要介绍了一个虹膜识别活体检测比赛中的情况，比赛中基本采用了提特征加分类器的方法。其中提取三种纹理特征（LBP，QBP，Gabor）然后进行特征融合（不知道咋融合的没有介绍），接SVM。此方案最终分类精度最高。

通过以上的调研我们基本上将思路确定为特征加分类器的解决方案。当然实际的项目相较于科研来说有更多的限制。比如计算能力（计算能力差），验证速度（要求实时），存储空间（内存小）在这些限制的前提下又要进一步思考应该如何进行验证。过程中就要在精度与速度上做tradeoff。又由于没有足够的数据量，没有足够的负样本，导致训练分类器的方案流产，选择了另外一种单边的验证思路。最终的验证还没有做。今天主要将虹膜检测中活体检测的一些大概方法介绍给大家。初入工业界，觉得工业界有属于它的需要去敬畏的东西。希望能尽快适应工业界的模式。

对于接下来公众号更新，我会在近期做一个规划，虽然属于自己时间不多，但仍然希望内容上更有条理，感谢支持，么么哒~

[1] Z. Sun, H. Zhang, T. Tan, and J. Wang, Iris Image Classification Based on Hierarchical Visual Codebook, IEEE Transactions on Pattern Analysis and Machine Intelligence, 2014

[3] F. Zhang, B. Du, and L. Zhang, Saliency-Guided Unsupervised Feature Learning for Scene Classification, IEEE Transaction on Geoscience and Remote Sensing, 53(4): 2175-2184, 2014

